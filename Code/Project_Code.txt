=== FILE: App\Http\Controllers\Backend\DashboardController.php ===
<?php

namespace App\Http\Controllers\Backend;

use App\Http\Controllers\Controller;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\DB;
use App\Models\SuperAdmin\GlobalSetup\Company;

class DashboardController extends Controller
{
    /** Helper: current user id (Auth first, then forced from config) */
    private function currentUserId(): ?int
    {
        $forced = config('header.dev_force_user_id'); // null or int
        return Auth::id() ?? $forced;
    }

    /**
     * Public landing (guest) — tenant-aware.
     * If a user exists, immediately redirect to the correct index within the user's tenant.
     *
     * Example:
     *   If user belongs to Trimatric Global but opens /company/abc-limited/dashboard/public,
     *   we redirect them to /company/trimatric-global/dashboard to keep tenant context canonical.
     */
    public function public(?Company $company = null)
    {
        $uid = $this->currentUserId();

        if ($uid) {
            // --- Canonicalize to user's own tenant ------------------------------
            $user = DB::table('users')->where('id', $uid)->first();
            $targetSlug = null;

            if ($user) {
                $userCompanyId = (int) ($user->company_id ?? 0);
                if ($userCompanyId > 0) {
                    $targetSlug = DB::table('companies')->where('id', $userCompanyId)->value('slug');
                } else {
                    // Optional: fallback via role -> company_id
                    $roleId = (int) ($user->role_id ?? 0);
                    if ($roleId > 0) {
                        $roleCompanyId = (int) DB::table('roles')->where('id', $roleId)->value('company_id');
                        if ($roleCompanyId > 0) {
                            $targetSlug = DB::table('companies')->where('id', $roleCompanyId)->value('slug');
                        }
                    }
                }
            }

            return $targetSlug
                ? redirect()->route('backend.company.dashboard.index', ['company' => $targetSlug])
                : redirect()->route('backend.dashboard.index');
        }

        // Guest → show public landing; header will brand via slug (if any)
        return view('backend.dashboard.public', [
            'title' => $company ? ($company->name . ' | Dashboard') : 'Welcome | Dashboard',
        ]);
    }

    /**
     * Role-aware dashboard index — tenant-aware.
     * If no user, go to the matching public page in SAME context.
     * If authenticated, ensure the URL's tenant matches the user's tenant (canonicalize).
     */
    public function index(?Company $company = null)
    {
        $uid = $this->currentUserId();

        // No user → send to public (keep tenant/global context)
        if (!$uid) {
            return $company
                ? redirect()->route('backend.company.dashboard.public', ['company' => $company->slug])
                : redirect()->route('backend.dashboard.public');
        }

        // Pull user & role_type
        $user = DB::table('users')->where('id', $uid)->first();
        if (!$user) {
            return $company
                ? redirect()->route('backend.company.dashboard.public', ['company' => $company->slug])
                : redirect()->route('backend.dashboard.public');
        }

        // --- Canonicalize tenant context for authenticated users -----------------
        // If URL has a company slug that differs from the user's company slug, redirect to user's tenant.
        // If URL has no slug but user has a tenant, redirect to that tenant.
        $userCompanySlug = null;
        $userCompanyId = (int) ($user->company_id ?? 0);
        if ($userCompanyId > 0) {
            $userCompanySlug = DB::table('companies')->where('id', $userCompanyId)->value('slug');
        } else {
            // Optional: fallback via role -> company_id
            $roleId = (int) ($user->role_id ?? 0);
            if ($roleId > 0) {
                $roleCompanyId = (int) DB::table('roles')->where('id', $roleId)->value('company_id');
                if ($roleCompanyId > 0) {
                    $userCompanySlug = DB::table('companies')->where('id', $roleCompanyId)->value('slug');
                }
            }
        }

        if ($company) {
            if ($userCompanySlug && $company->slug !== $userCompanySlug) {
                return redirect()->route('backend.company.dashboard.index', ['company' => $userCompanySlug]);
            }
        } else {
            if ($userCompanySlug) {
                return redirect()->route('backend.company.dashboard.index', ['company' => $userCompanySlug]);
            }
        }

        // Determine role type view as you already do
        $role = DB::table('roles')->where('id', $user->role_id)->first();
        $roleType = null;
        if ($role) {
            $roleType = DB::table('role_types')->where('id', $role->role_type_id)->value('name');
        }

        // Normalize role type → key
        $key = $roleType
            ? strtolower(str_replace([' ', '_'], ['-', '-'], $roleType))
            : 'guest';

        // Map role_type key → view
        $map = [
            'super-admin' => 'backend.dashboard.super-admin.index',
            'ceo'         => 'backend.dashboard.ceo.index',
            'zonal-admin' => 'backend.dashboard.zonal-admin.index',
            // defaults
            'guest'       => 'backend.dashboard.public',
        ];

        $view = $map[$key] ?? $map['guest'];

        // If somehow we still landed on a "guest" view while having a user, fallback:
        if ($view === 'backend.dashboard.public') {
            $view = 'backend.dashboard.super-admin.index';
        }

        return view($view, [
            'title'    => 'Dashboard',
            'user'     => $user,
            'roleType' => $roleType,
        ]);
    }
}

=== END FILE  ===


=== FILE: App\Http\Controllers\SuperAdmin\GlobalSetup\CompanyController.php ===
<?php

namespace App\Http\Controllers\SuperAdmin\GlobalSetup;

use App\Http\Controllers\Controller;
use App\Models\SuperAdmin\GlobalSetup\Company;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Route;
use Illuminate\Support\Str;

class CompanyController extends Controller
{
    private ?int $userId = null;
    private ?int $companyId = null;

    /**
     * Must match menus.uri for Companies index in your menus seed.
     */
    private string $menuUri = 'superadmin.globalsetup.companies.index';

    public function __construct()
    {
        // current user (auth or forced)
        $forcedUserId = config('header.dev_force_user_id'); // null or an id
        $this->userId = Auth::id() ?? $forcedUserId;

        // resolve company_id from user; if missing, fall back to role.company_id
        if ($this->userId) {
            $userCompanyId = DB::table('users')->where('id', $this->userId)->value('company_id');

            if ($userCompanyId) {
                $this->companyId = (int) $userCompanyId;
            } else {
                $roleId = DB::table('users')->where('id', $this->userId)->value('role_id');
                if ($roleId) {
                    $this->companyId = (int) DB::table('roles')->where('id', $roleId)->value('company_id');
                }
            }
        }
    }

    /** List + search + sort + offset/limit pagination */
    public function index(Request $request)
    {
        $this->abortIfNoMenuAccess($this->userId, $this->menuUri);

        $page   = max(1, (int) $request->query('page', 1));
        $limit  = max(1, min(100, (int) $request->query('limit', 10)));
        $search = trim((string) $request->query('search', ''));
        $offset = ($page - 1) * $limit;

        $sort = (string) $request->query('sort', 'id');
        $dir  = strtolower((string) $request->query('dir', 'desc')) === 'asc' ? 'asc' : 'desc';
        $allowedSorts = ['id', 'name', 'status', 'created_at'];
        if (!in_array($sort, $allowedSorts, true)) $sort = 'id';

        $base = DB::table('companies as c')
            ->join('countries as k', 'k.id', '=', 'c.country_id')
            ->whereNull('c.deleted_at')
            ->select('c.id','c.name','c.logo','c.status','c.created_at','k.name as country_name');

        if ($search !== '') {
            $like = '%' . $search . '%';
            $base->where(function ($q) use ($like) {
                $q->where('c.name', 'like', $like)
                  ->orWhere('k.name', 'like', $like);
            });
        }

        $total = (clone $base)->count();

        $rows = (clone $base)
            ->orderBy($sort === 'created_at' ? 'c.created_at' : "c.{$sort}", $dir)
            ->limit($limit)
            ->offset($offset)
            ->get();

        $totalPages = max(1, (int) ceil($total / $limit));
        $winStart   = max(1, $page - 3);
        $winEnd     = min($totalPages, $page + 3);

        $can = $this->actionPermissions($this->userId, $this->menuUri);

        return view('backend.modules.global-setup.companies.index', compact(
            'rows', 'page', 'limit', 'search', 'total', 'totalPages', 'winStart', 'winEnd', 'can', 'sort', 'dir'
        ))->with('title', 'Companies');
    }

    public function create()
    {
        $this->abortIfForbidden('create');

        $countries = DB::table('countries')->whereNull('deleted_at')->orderBy('name')->get(['id','name']);
        return view('backend.modules.global-setup.companies.create', [
            'title'     => 'Add Company',
            'countries' => $countries,
        ]);
    }

    public function store(Request $request)
    {
        $this->abortIfForbidden('create');

        $messages = [
            'country_id.required' => 'Please select a country.',
            'name.required'       => 'Please enter a company name.',
            'status.required'     => 'Please select a status.',
        ];

        $validated = $request->validate([
            'country_id' => ['required','integer','exists:countries,id'],
            'name'       => ['required','string','max:190','unique:companies,name,NULL,id,deleted_at,NULL'],
            'description'=> ['nullable','string','max:1000'],
            'address'    => ['nullable','string','max:500'],
            'contact_no' => ['nullable','string','max:50'],
            'status'     => ['required','in:0,1'],
            'logo'       => ['nullable','image','mimes:jpg,jpeg,png,webp','max:2048'],
        ], $messages);

        $data = collect($validated)->except('logo')->toArray();

        $company = new Company($data);
        $company->created_by = $this->userId ?: 0;
        $company->updated_by = $this->userId ?: 0;

        // logo handling
        if ($request->hasFile('logo')) {
            $countryName = DB::table('countries')->where('id', $validated['country_id'])->value('name') ?? 'unknown';
            $countrySlug = Str::slug($countryName);
            $companySlug = Str::slug($validated['name']);

            $folderPath = public_path("assets/images/{$countrySlug}/{$companySlug}/logo");
            if (!is_dir($folderPath)) mkdir($folderPath, 0777, true);

            $file     = $request->file('logo');
            $fileName = "{$companySlug}-logo-".time().'.'.$file->getClientOriginalExtension();
            $file->move($folderPath, $fileName);

            $company->logo = "assets/images/{$countrySlug}/{$companySlug}/logo/{$fileName}";
        }

        $company->save();

        $this->logActivity('add', 'companies', $company->id, [
            'name' => $company->name, 'status' => $company->status
        ]);

        return redirect()->route('superadmin.globalsetup.companies.index')
            ->with('status', 'Company created successfully.');
    }

    public function show($id)
    {
        $this->abortIfForbidden('view');

        $company = Company::findOrFail($id);
        $country = DB::table('countries')->where('id',$company->country_id)->value('name');

        return view('backend.modules.global-setup.companies.show', [
            'title'   => 'View Company',
            'company' => $company,
            'country' => $country,
        ]);
    }

    public function edit($id)
    {
        $this->abortIfForbidden('edit');

        $company   = Company::findOrFail($id);
        $countries = DB::table('countries')->whereNull('deleted_at')->orderBy('name')->get(['id','name']);

        return view('backend.modules.global-setup.companies.edit', [
            'title'     => 'Edit Company',
            'company'   => $company,
            'countries' => $countries,
        ]);
    }

    public function update(Request $request, $id)
    {
        $this->abortIfForbidden('edit');

        $company = Company::findOrFail($id);

        $messages = [
            'country_id.required' => 'Please select a country.',
            'name.required'       => 'Please enter a company name.',
            'status.required'     => 'Please select a status.',
        ];

        $validated = $request->validate([
            'country_id' => ['required','integer','exists:countries,id'],
            'name'       => ['required','string','max:190','unique:companies,name,'.$company->id.',id,deleted_at,NULL'],
            'description'=> ['nullable','string','max:1000'],
            'address'    => ['nullable','string','max:500'],
            'contact_no' => ['nullable','string','max:50'],
            'status'     => ['required','in:0,1'],
            'logo'       => ['nullable','image','mimes:jpg,jpeg,png,webp','max:2048'],
        ], $messages);

        $data = collect($validated)->except('logo')->toArray();
        $company->fill($data);
        $company->updated_by = $this->userId ?: 0;

        if ($request->hasFile('logo')) {
            $countryName = DB::table('countries')->where('id', $validated['country_id'])->value('name') ?? 'unknown';
            $countrySlug = Str::slug($countryName);
            $companySlug = Str::slug($validated['name']);

            $folderPath = public_path("assets/images/{$countrySlug}/{$companySlug}/logo");
            if (!is_dir($folderPath)) mkdir($folderPath, 0777, true);

            $file     = $request->file('logo');
            $fileName = "{$companySlug}-logo-".time().'.'.$file->getClientOriginalExtension();
            $file->move($folderPath, $fileName);

            $company->logo = "assets/images/{$countrySlug}/{$companySlug}/logo/{$fileName}";
        }

        $company->save();

        $this->logActivity('edit', 'companies', $company->id, [
            'name' => $company->name, 'status' => $company->status
        ]);

        return redirect()->route('superadmin.globalsetup.companies.index')
            ->with('status', 'Company updated successfully.');
    }

    /** AJAX soft delete */
    public function destroy($id)
    {
        $this->abortIfForbidden('delete');

        $company = Company::findOrFail($id);
        $company->updated_by = $this->userId ?: 0;
        $company->save();
        $company->delete();

        $this->logActivity('delete', 'companies', (int) $id, [
            'name' => $company->name
        ]);

        return response()->json(['ok' => true, 'id' => (int) $id]);
    }

    /* ================= RBAC helpers (same pattern you used) ================= */

    private function actionPermissions(?int $userId, string $menuUri): array
    {
        if (!$userId) abort(403, 'Forbidden (no user)');
        $roleId = (int) DB::table('users')->where('id', $userId)->value('role_id');
        if (!$roleId) abort(403, 'Forbidden (no role)');

        $actions = DB::table('role_menu_action_permissions as rmap')
            ->join('menus as m', 'm.id', '=', 'rmap.menu_id')
            ->join('actions as a', 'a.id', '=', 'rmap.action_id')
            ->where('m.uri', $menuUri)
            ->where('rmap.role_id', $roleId)
            ->where('rmap.allowed', 1)
            ->pluck('a.name')
            ->toArray();

        return [
            'view'   => in_array('view', $actions, true),
            'create' => in_array('create', $actions, true),
            'edit'   => in_array('edit', $actions, true),
            'delete' => in_array('delete', $actions, true),
        ];
    }

    private function logActivity(string $action, string $table, int $rowId, array $details = []): void
    {
        DB::table('activity_logs')->insert([
            'company_id' => $this->companyId ?: 0,
            'user_id'    => $this->userId ?: 0,
            'action'     => $action,
            'table_name' => $table,
            'row_id'     => $rowId,
            'details'    => json_encode($details),
            'ip_address' => request()->ip() ?? '127.0.0.1',
            'time_local' => now(),
            'time_dhaka' => now(),
            'created_by' => $this->userId ?: 0,
            'updated_by' => $this->userId ?: 0,
            'created_at' => now(),
            'updated_at' => now(),
        ]);
    }

    private function abortIfForbidden(string $action): void
    {
        $perm = $this->actionPermissions($this->userId, $this->menuUri);
        if (empty($perm[$action])) abort(403, "Forbidden ({$action})");
    }

    private function abortIfNoMenuAccess(?int $userId, string $menuUri): void
    {
        if (!$userId) abort(403, 'Forbidden (no user)');
        $roleId = (int) DB::table('users')->where('id', $userId)->value('role_id');

        $has = DB::table('role_menu_mappings as rmm')
            ->join('menus as m', 'm.id', '=', 'rmm.menu_id')
            ->where('m.uri', $menuUri)
            ->where('rmm.role_id', $roleId)
            ->whereNull('rmm.deleted_at')
            ->exists();

        if (!$has) abort(403, 'Forbidden (no menu access)');
    }
}

=== END FILE  ===

=== FILE: App\Http\Controllers\SuperAdmin\GlobalSetup\CountryController.php ===

<?php

namespace App\Http\Controllers\SuperAdmin\GlobalSetup;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use App\Models\SuperAdmin\GlobalSetup\Country;

class CountryController extends Controller
{
    /** Need to swap to Auth later */
    private int $userId;
    private int $companyId;

    /**
     * Route name (menu URI) used for RBAC lookups.
     * Must match the `menus.uri` for Countries index in my Menu table
     */
    private string $menuUri = 'superadmin.globalsetup.countries.index';

    public function __construct()
    {
        // NOW (no authentication yet)
        $this->userId    = 1; // Super Admin
        $this->companyId = 1; // Trimatric Global

        // LATER (after auth):
        // $this->userId    = auth()->id() ?? 1;
        // $this->companyId = auth()->user()->company_id ?? 1;
    }

    /** OFFSET/LIMIT pagination + simple LIKE search (name, short_code) + safe sorting. */
    public function index(Request $request)
    {
        $this->abortIfNoMenuAccess($this->userId, $this->menuUri);

        $page   = max(1, (int) $request->query('page', 1));
        $limit  = max(1, min(100, (int) $request->query('limit', 10))); // cap 100
        $search = trim((string) $request->query('search', ''));
        $offset = ($page - 1) * $limit;

        // Sorting (whitelist + normalize)
        $sort = (string) $request->query('sort', 'id');
        $dir  = strtolower((string) $request->query('dir', 'desc')) === 'asc' ? 'asc' : 'desc';
        $allowedSorts = ['id', 'name', 'short_code', 'created_at'];
        if (!in_array($sort, $allowedSorts, true)) {
            $sort = 'id';
        }

        $base = DB::table('countries')
            ->select('id', 'name', 'short_code', 'created_at')
            ->whereNull('deleted_at');

        if ($search !== '') {
            $like = '%' . $search . '%';
            $base->where(function ($q) use ($like) {
                $q->where('name', 'like', $like)
                  ->orWhere('short_code', 'like', $like);
            });
        }

        $total = (clone $base)->count();

        $rows = (clone $base)
            ->orderBy($sort, $dir)
            ->limit($limit)
            ->offset($offset)
            ->get();

        $totalPages = max(1, (int) ceil($total / $limit));
        $winStart   = max(1, $page - 3);
        $winEnd     = min($totalPages, $page + 3);

        $can = $this->actionPermissions($this->userId, $this->menuUri);

        return view('backend.modules.global-setup.countries.index', compact(
            'rows', 'page', 'limit', 'search', 'total', 'totalPages', 'winStart', 'winEnd', 'can', 'sort', 'dir'
        ))->with('title', 'Countries (Index)');
    }

    public function create()
    {
        $this->abortIfForbidden('create');

        return view('backend.modules.global-setup.countries.create', [
            'title' => 'Add Country'
        ]);
    }

    public function store(Request $request)
    {
        $this->abortIfForbidden('create');

        $messages = [
            'name.required' => 'Please enter a country name.',
            'name.max' => 'Country name may not be greater than :max characters.',
            'name.unique' => 'This country name already exists.',
            'short_code.max' => 'Short code may not be greater than :max characters.'
        ];
        $attributes = [
            'name' => 'Country name',
            'short_code' => 'Short code'
        ];

        $validated = $request->validate([
            'name' => ['required', 'string', 'max:150', 'unique:countries,name,NULL,id,deleted_at,NULL'],
            'short_code' => ['nullable', 'string', 'max:10']
        ], $messages, $attributes);

        $country = new Country($validated);
        $country->created_by = $this->userId;
        $country->updated_by = $this->userId;
        $country->save();

        $this->logActivity('add', 'countries', $country->id, [
            'name' => $country->name,
            'short_code' => $country->short_code
        ]);

        return redirect()
            ->route('superadmin.globalsetup.countries.index')
            ->with('status', 'Country created successfully.');
    }

    public function show($id)
    {
        $this->abortIfForbidden('view');

        $country = Country::findOrFail($id);

        return view('backend.modules.global-setup.countries.show', [
            'title' => 'View Country',
            'country' => $country
        ]);
    }

    public function edit($id)
    {
        $this->abortIfForbidden('edit');

        $country = Country::findOrFail($id);

        return view('backend.modules.global-setup.countries.edit', [
            'title' => 'Edit Country',
            'country' => $country
        ]);
    }

    public function update(Request $request, $id)
    {
        $this->abortIfForbidden('edit');

        $country = Country::findOrFail($id);

        $messages = [
            'name.required' => 'Please enter a country name.',
            'name.max' => 'Country name may not be greater than :max characters.',
            'name.unique' => 'This country name already exists.',
            'short_code.max' => 'Short code may not be greater than :max characters.'
        ];
        $attributes = [
            'name' => 'Country name',
            'short_code' => 'Short code'
        ];

        $validated = $request->validate([
            'name' => ['required', 'string', 'max:150', 'unique:countries,name,' . $country->id . ',id,deleted_at,NULL'],
            'short_code' => ['nullable', 'string', 'max:10']
        ], $messages, $attributes);

        $country->fill($validated);
        $country->updated_by = $this->userId;
        $country->save();

        $this->logActivity('edit', 'countries', $country->id, [
            'name' => $country->name,
            'short_code' => $country->short_code
        ]);

        return redirect()
            ->route('superadmin.globalsetup.countries.index')
            ->with('status', 'Country updated successfully.');
    }

    /** AJAX-friendly soft delete */
    public function destroy($id)
    {
        $this->abortIfForbidden('delete');

        $country = Country::findOrFail($id);
        $country->updated_by = $this->userId;
        $country->save();
        $country->delete();

        $this->logActivity('delete', 'countries', (int) $id, [
            'name' => $country->name,
            'short_code' => $country->short_code
        ]);

        return response()->json(['ok' => true, 'id' => (int) $id]);
    }

    /* ================= Helpers ================= */

    private function actionPermissions(int $userId, string $menuUri): array
    {
        $roleId = (int) DB::table('users')->where('id', $userId)->value('role_id');
        if (!$roleId) {
            abort(403, 'Forbidden (no role)');
        }

        $actions = DB::table('role_menu_action_permissions as rmap')
            ->join('menus as m', 'm.id', '=', 'rmap.menu_id')
            ->join('actions as a', 'a.id', '=', 'rmap.action_id')
            ->where('m.uri', $menuUri)
            ->where('rmap.role_id', $roleId)
            ->where('rmap.allowed', 1)
            ->pluck('a.name')
            ->toArray();

        return [
            'view' => in_array('view', $actions, true),
            'create' => in_array('create', $actions, true),
            'edit' => in_array('edit', $actions, true),
            'delete' => in_array('delete', $actions, true)
        ];
    }

    private function logActivity(string $action, string $table, int $rowId, array $details = []): void
    {
        DB::table('activity_logs')->insert([
            'company_id' => $this->companyId,
            'user_id' => $this->userId,
            'action' => $action,
            'table_name' => $table,
            'row_id' => $rowId,
            'details' => json_encode($details),
            'ip_address' => request()->ip() ?? '127.0.0.1',
            'time_local' => now(),
            'time_dhaka' => now(),
            'created_by' => $this->userId,
            'updated_by' => $this->userId,
            'created_at' => now(),
            'updated_at' => now()
        ]);
    }

    private function abortIfForbidden(string $action): void
    {
        $perm = $this->actionPermissions($this->userId, $this->menuUri);
        if (empty($perm[$action])) {
            abort(403, "Forbidden ({$action})");
        }
    }

    private function abortIfNoMenuAccess(int $userId, string $menuUri): void
    {
        $roleId = (int) DB::table('users')->where('id', $userId)->value('role_id');
        $has = DB::table('role_menu_mappings as rmm')
            ->join('menus as m', 'm.id', '=', 'rmm.menu_id')
            ->where('m.uri', $menuUri)
            ->where('rmm.role_id', $roleId)
            ->whereNull('rmm.deleted_at')
            ->exists();

        if (!$has) {
            abort(403, 'Forbidden (no menu access)');
        }
    }
}

=== END FILE  ===


=== FILE: App\Models\SuperAdmin\GlobalSetup\Country.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;

class Country extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'name', 'short_code', 'created_by', 'updated_by',
    ];

    // Relationships
    public function companies()
    {
        return $this->hasMany(Company::class);
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\GlobalSetup\Company.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;

class Company extends Model
{
    use SoftDeletes;

    protected $table = 'companies';

    protected $fillable = [
        'country_id',
        'name',
        'description',
        'address',
        'contact_no',
        'logo',
        'status',       // <-- added
        'created_by',
        'updated_by',
    ];

    protected $casts = [
        'status'     => 'integer',   // <-- added
        'created_at' => 'datetime',
        'updated_at' => 'datetime',
        'deleted_at' => 'datetime',
    ];
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\GlobalSetup\Division.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;

class Division extends Model
{
    public $timestamps = true;
    protected $fillable = ['name','short_code','status','created_by','updated_by'];

    public function districts()
    {
        return $this->hasMany(District::class);
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\GlobalSetup\District.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;

class District extends Model
{
    public $timestamps = true;
    protected $fillable = ['division_id','name','dist_no','short_code','status','created_by','updated_by'];

    public function division()
    {
        return $this->belongsTo(Division::class);
    }

    public function upazilas()
    {
        return $this->hasMany(Upazila::class);
    }

    public function clusters()
    {
        return $this->hasMany(ClusterMaster::class, 'district_id');
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\GlobalSetup\Upazila.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;

class Upazila extends Model
{
    public $timestamps = true;
    protected $fillable = ['district_id','name','upa_no','short_code','status','created_by','updated_by'];

    public function district()
    {
        return $this->belongsTo(District::class);
    }

    public function clusterMapping()
    {
        return $this->hasOne(ClusterUpazilaMapping::class, 'upazila_id');
    }

    public function cluster()
    {
        return $this->belongsToMany(ClusterMaster::class, 'cluster_upazila_mappings', 'upazila_id', 'cluster_id');
    }
}



=== END FILE  ===


=== FILE: App\Models\SuperAdmin\GlobalSetup\ClusterMaster.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;
use App\Models\SuperAdmin\UserManagement\User; // matches your tree

class ClusterMaster extends Model
{
    public $timestamps = true;
    protected $table = 'cluster_masters';
    protected $fillable = ['district_id','cluster_name','cluster_no','short_code','cluster_supervisor_id','status','created_by','updated_by'];

    public function district()
    {
        return $this->belongsTo(District::class, 'district_id');
    }

    public function supervisor()
    {
        return $this->belongsTo(User::class, 'cluster_supervisor_id');
    }

    public function mappings()
    {
        return $this->hasMany(ClusterUpazilaMapping::class, 'cluster_id');
    }

    public function upazilas()
    {
        return $this->belongsToMany(Upazila::class, 'cluster_upazila_mappings', 'cluster_id', 'upazila_id');
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\GlobalSetup\ClusterUpazilaMapping.php  ===

<?php

namespace App\Models\SuperAdmin\GlobalSetup;

use Illuminate\Database\Eloquent\Model;

class ClusterUpazilaMapping extends Model
{
    public $timestamps = true;
    protected $table = 'cluster_upazila_mappings';
    protected $fillable = ['cluster_id','upazila_id','status','created_by','updated_by'];

    public function cluster()
    {
        return $this->belongsTo(ClusterMaster::class, 'cluster_id');
    }

    public function upazila()
    {
        return $this->belongsTo(Upazila::class, 'upazila_id');
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\UserManagement\Action.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\MenuAction;
use App\Models\SuperAdmin\UserManagement\RoleMenuActionPermission;

class Action extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'name',
        'display_name',
        'description',
        'created_by',
        'updated_by'
    ];

    public function menuActions()
    {
        return $this->hasMany(MenuAction::class);
    }

    public function roleMenuActionPermissions()
    {
        return $this->hasMany(RoleMenuActionPermission::class);
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\UserManagement\ActivityLog.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\GlobalSetup\Company;
use App\Models\SuperAdmin\UserManagement\User;

class ActivityLog extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'company_id',
        'user_id',
        'action',
        'table_name',
        'row_id',
        'details',
        'ip_address',
        'time_local',
        'time_dhaka',
        'created_by',
        'updated_by',
    ];

    protected $casts = [
        'time_local' => 'datetime',
        'time_dhaka' => 'datetime',
    ];

    public function company()
    {
        return $this->belongsTo(Company::class);
    }

    public function user()
    {
        return $this->belongsTo(User::class);
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\UserManagement\Menu.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\Role;
use App\Models\SuperAdmin\UserManagement\MenuAction;
use App\Models\SuperAdmin\UserManagement\RoleMenuActionPermission;

class Menu extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'parent_id',
        'name',
        'uri',
        'icon',
        'menu_order',
        'description',
        'created_by',
        'updated_by',
    ];

    public function parent()
    {
        return $this->belongsTo(Menu::class, 'parent_id');
    }

    public function children()
    {
        return $this->hasMany(Menu::class, 'parent_id')->orderBy('menu_order');
    }

    public function roles()
    {
        return $this->belongsToMany(Role::class, 'role_menu_mappings')
                    ->withTimestamps()
                    ->withPivot(['access_type', 'deleted_at']);
    }

    public function menuActions()
    {
        return $this->hasMany(MenuAction::class);
    }

    public function roleMenuActionPermissions()
    {
        return $this->hasMany(RoleMenuActionPermission::class);
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\UserManagement\MenuAction.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\Menu;
use App\Models\SuperAdmin\UserManagement\Action;

class MenuAction extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'menu_id',
        'action_id',
        'button_label',
        'button_icon',
        'button_order',
        'created_by',
        'updated_by',
    ];

    public function menu()
    {
        return $this->belongsTo(Menu::class);
    }

    public function action()
    {
        return $this->belongsTo(Action::class);
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\UserManagement\Role.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\GlobalSetup\Company;
use App\Models\SuperAdmin\UserManagement\RoleType;
use App\Models\SuperAdmin\UserManagement\RoleMenuMapping;
use App\Models\SuperAdmin\UserManagement\Menu;
use App\Models\SuperAdmin\UserManagement\RoleMenuActionPermission;
use App\Models\SuperAdmin\UserManagement\User;

class Role extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'company_id',
        'role_type_id',
        'name',
        'description',
        'created_by',
        'updated_by',
    ];

    public function company()
    {
        return $this->belongsTo(Company::class);
    }

    public function roleType()
    {
        return $this->belongsTo(RoleType::class);
    }

    public function roleMenuMappings()
    {
        return $this->hasMany(RoleMenuMapping::class);
    }

    public function menus()
    {
        return $this->belongsToMany(Menu::class, 'role_menu_mappings')
                    ->withTimestamps()
                    ->withPivot(['access_type', 'deleted_at']);
    }

    public function roleMenuActionPermissions()
    {
        return $this->hasMany(RoleMenuActionPermission::class);
    }

    public function users()
    {
        return $this->hasMany(User::class);
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\UserManagement\RoleMenuActionPermission.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\Role;
use App\Models\SuperAdmin\UserManagement\Menu;
use App\Models\SuperAdmin\UserManagement\Action;

class RoleMenuActionPermission extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'role_id',
        'menu_id',
        'action_id',
        'allowed',
        'created_by',
        'updated_by',
    ];

    public function role()
    {
        return $this->belongsTo(Role::class);
    }

    public function menu()
    {
        return $this->belongsTo(Menu::class);
    }

    public function action()
    {
        return $this->belongsTo(Action::class);
    }
}


=== END FILE  ===


=== FILE: App\Models\SuperAdmin\UserManagement\RoleMenuMapping.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\Role;
use App\Models\SuperAdmin\UserManagement\Menu;

class RoleMenuMapping extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'role_id',
        'menu_id',
        'access_type',
        'created_by',
        'updated_by',
    ];

    public function role()
    {
        return $this->belongsTo(Role::class);
    }

    public function menu()
    {
        return $this->belongsTo(Menu::class);
    }
}


=== END FILE  ===



=== FILE: App\Models\SuperAdmin\UserManagement\RoleType.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
use App\Models\SuperAdmin\UserManagement\Role;

class RoleType extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'name',
        'description',
        'created_by',
        'updated_by'
    ];

    public function roles()
    {
        return $this->hasMany(Role::class);
    }
}



=== END FILE  ===


=== FILE: App\Models\SuperAdmin\UserManagement\User.php  ===

<?php

namespace App\Models\SuperAdmin\UserManagement;

use Illuminate\Database\Eloquent\SoftDeletes;
use Illuminate\Foundation\Auth\User as Authenticatable;
use App\Models\SuperAdmin\GlobalSetup\Company;
use App\Models\SuperAdmin\UserManagement\Role;
use App\Models\SuperAdmin\UserManagement\ActivityLog;

class User extends Authenticatable
{
    use SoftDeletes;

    protected $fillable = [
        'company_id',
        'role_id',
        'name',
        'email',
        'password',
        'remember_token',
        'status',
        'created_by',
        'updated_by',
    ];

    protected $hidden = [
        'password',
        'remember_token',
    ];

    protected $casts = [
        'email_verified_at' => 'datetime',
    ];

    public function company()
    {
        return $this->belongsTo(Company::class);
    }

    public function role()
    {
        return $this->belongsTo(Role::class);
    }

    public function activityLogs()
    {
        return $this->hasMany(ActivityLog::class);
    }
}


=== END FILE  ===



=== FILE: App\Providers\AppServiceProvider.php  ===

<?php

namespace App\Providers;

use Illuminate\Support\Facades\Route;
use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        //
    }

   public function boot(): void
{
    $routeBase = base_path('routes');

    $iterator = new \RecursiveIteratorIterator(
        new \RecursiveDirectoryIterator($routeBase, \FilesystemIterator::SKIP_DOTS)
    );

    foreach ($iterator as $file) {
        if (!$file->isFile() || $file->getExtension() !== 'php') {
            continue;
        }

        $fileName = $file->getFilename();

        // Skip Laravel defaults
        if (in_array($fileName, ['web.php', 'api.php', 'console.php', 'channels.php'], true)) {
            continue;
        }

        // Path parts relative to /routes (e.g. "SuperAdmin/GlobalSetup")
        $absPath     = $file->getPathname();
        $relative    = str_replace($routeBase . DIRECTORY_SEPARATOR, '', $absPath);
        $dirRelative = trim(str_replace($fileName, '', $relative), DIRECTORY_SEPARATOR);

        $urlPrefix  = '';
        $namePrefix = '';

        if ($dirRelative !== '') {
            $segments   = array_map(fn ($s) => strtolower($s), explode(DIRECTORY_SEPARATOR, $dirRelative));
            $urlPrefix  = implode('/', $segments);       // superadmin/globalsetup
            $namePrefix = implode('.', $segments) . '.'; // superadmin.globalsetup.
        }

        // Build the registrar and conditionally add prefix/as
        $registrar = \Illuminate\Support\Facades\Route::middleware('web');
        if ($urlPrefix !== '') {
            $registrar = $registrar->prefix($urlPrefix);
        }
        if ($namePrefix !== '') {
            $registrar = $registrar->as($namePrefix);
        }

        $registrar->group($absPath);
    }
}

}


=== END FILE  ===



=== FILE: App\Providers\ViewServiceProvider.php  ===

<?php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;
use Illuminate\Support\Facades\View;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Route;
use Illuminate\Support\Facades\Schema;

class ViewServiceProvider extends ServiceProvider
{
    public function register(): void {}

    public function boot(): void
    {
        View::composer('backend.layouts.partials.header', function ($view) {
            // --- Auth (real first, then forced via .env) -------------------------
            $forcedId = config('header.dev_force_user_id');
            $forcedId = is_numeric($forcedId) ? (int) $forcedId : null;

            $uid     = Auth::id() ?? $forcedId;
            $isGuest = ($uid === null);

            $headerUser    = null;
            $menuTree      = [];
            $headerCompany = null;

            if (!$isGuest) {
                $headerUser = DB::table('users')->where('id', $uid)->first();
                if (!$headerUser) {
                    $isGuest = true;
                }
            }

            // --- Company (from route slug or model; then user/role fallback) -----
            // Example URLs:
            //   /backend/company/abc-limited/dashboard/public
            //   /backend/company/trimatric-global/dashboard
            $route = request()->route();
            if ($route) {
                $param = $route->parameter('company'); // Company model or slug
                if ($param instanceof \App\Models\SuperAdmin\GlobalSetup\Company) {
                    $headerCompany = DB::table('companies')
                        ->where('id', $param->id)->where('status', 1)->whereNull('deleted_at')->first();
                } elseif (is_string($param) && $param !== '') {
                    $headerCompany = DB::table('companies')
                        ->where('slug', $param)->where('status', 1)->whereNull('deleted_at')->first();
                }
            }
            if (!$headerCompany && !$isGuest) {
                // If no slug/company from URL, try user's own company, then role->company
                $userCompanyId = (int) ($headerUser->company_id ?? 0);
                if ($userCompanyId > 0) {
                    $headerCompany = DB::table('companies')
                        ->where('id', $userCompanyId)->where('status', 1)->whereNull('deleted_at')->first();
                } else {
                    $roleId = (int) ($headerUser->role_id ?? 0);
                    if ($roleId > 0) {
                        $roleCompanyId = (int) DB::table('roles')->where('id', $roleId)->value('company_id');
                        if ($roleCompanyId > 0) {
                            $headerCompany = DB::table('companies')
                                ->where('id', $roleCompanyId)->where('status', 1)->whereNull('deleted_at')->first();
                        }
                    }
                }
            }

            // --- Canonicalize branding for authenticated users -------------------
            // Requirement:
            //  If a logged-in (forced or real) user opens another tenant's URL
            //  (e.g., /abc-limited/...), the header MUST reflect the user's actual
            //  company (e.g., Trimatric Global). This override keeps header branding
            //  consistent with the authenticated identity.
            if (!$isGuest) {
                $userCompanyId = (int) ($headerUser->company_id ?? 0);
                if ($userCompanyId > 0) {
                    $userCompany = DB::table('companies')
                        ->where('id', $userCompanyId)->where('status', 1)->whereNull('deleted_at')->first();

                    if ($userCompany) {
                        $headerCompany = $userCompany; // override any slug-derived company
                    }
                } else {
                    // Optional: fallback via role -> company_id (keeps your current behavior)
                    $roleId = (int) ($headerUser->role_id ?? 0);
                    if ($roleId > 0) {
                        $roleCompanyId = (int) DB::table('roles')->where('id', $roleId)->value('company_id');
                        if ($roleCompanyId > 0) {
                            $roleCompany = DB::table('companies')
                                ->where('id', $roleCompanyId)->where('status', 1)->whereNull('deleted_at')->first();
                            if ($roleCompany) {
                                $headerCompany = $roleCompany;
                            }
                        }
                    }
                }
            }

            // Brand name for dynamic messages (fallback = ArchReach)
            $brandName = $headerCompany->name ?? 'ArchReach';
            $companyId = $headerCompany->id ?? (($headerUser->company_id ?? null) ?: null);

            // --- Registration state (config/header.php driven) -------------------
            // Works now with IS_FORCED_REGISTRATION, and later with your real table
            $isRegistered = false;
            if (!$isGuest) {
                $src        = config('header.registration.source', 'auto');
                $envReg     = (bool) config('header.dev_force_registered');

                $table      = config('header.registration.table');
                $userCol    = config('header.registration.user_column', 'user_id');
                $statusCol  = config('header.registration.status_column', 'status');
                $activeVal  = config('header.registration.status_active', '1');
                $companyCol = config('header.registration.company_column');

                $hasTable   = ($table && Schema::hasTable($table));

                if ($src === 'env') {
                    $isRegistered = $envReg;
                } else {
                    if ($hasTable) {
                        $q = DB::table($table);

                        if (Schema::hasColumn($table, 'deleted_at')) {
                            $q->whereNull('deleted_at');
                        }
                        if ($userCol && Schema::hasColumn($table, $userCol)) {
                            $q->where($userCol, $uid);
                        }
                        if ($companyCol && $companyId && Schema::hasColumn($table, $companyCol)) {
                            $q->where($companyCol, $companyId);
                        }
                        if ($statusCol && Schema::hasColumn($table, $statusCol)) {
                            $q->where($statusCol, $activeVal);
                        }

                        $isRegistered = $q->exists();

                        if (!$isRegistered && $src === 'auto') {
                            $isRegistered = $envReg; // graceful fallback while DB evolves
                        }
                    } else {
                        $isRegistered = $envReg;
                    }
                }
            }

            // --- Menus appear only when authenticated AND registered -------------
            if (!$isGuest && $isRegistered) {
                $roleId = (int) ($headerUser->role_id ?? 0);
                if ($roleId > 0) {
                    $menus = DB::table('menus as m')
                        ->join('role_menu_mappings as rmm', 'rmm.menu_id', '=', 'm.id')
                        ->where('rmm.role_id', $roleId)
                        ->whereNull('m.deleted_at')
                        ->whereNull('rmm.deleted_at')
                        ->select('m.id','m.parent_id','m.name','m.uri','m.icon','m.menu_order')
                        ->orderBy('m.menu_order')
                        ->get()
                        ->map(function ($m) {
                            $m->url = ($m->uri && Route::has($m->uri)) ? route($m->uri) : '#';
                            return $m;
                        });

                    $byParent = [];
                    foreach ($menus as $m) {
                        $byParent[$m->parent_id ?? 0][] = $m;
                    }
                    foreach (($byParent[0] ?? []) as $parent) {
                        $children = $byParent[$parent->id] ?? [];
                        $menuTree[] = (object) [
                            'id'       => $parent->id,
                            'name'     => $parent->name,
                            'icon'     => $parent->icon,
                            'uri'      => $parent->uri,
                            'url'      => $parent->url,
                            'children' => $children,
                        ];
                    }
                }
            }

            // --- Header UI flags (and dynamic toasts using $brandName) -----------
            $ui = (object) [
                'loginVisible'   => true,
                'loginEnabled'   => true,
                'logoutVisible'  => true,
                'logoutEnabled'  => false,

                'registerVisible' => false,
                'registerEnabled' => false,
                'editRegVisible'  => false,
                'editRegEnabled'  => false,

                'toastMessage'    => null,
            ];

            if ($isGuest) {
                // Guest: Register visible but disabled, Login enabled
                $ui->loginEnabled     = true;
                $ui->logoutEnabled    = false;

                $ui->registerVisible  = true;
                $ui->registerEnabled  = false;

                $ui->editRegVisible   = false;
                $ui->editRegEnabled   = false;

                // Dynamic brand in welcome message (e.g., "Trimatric Global" or "ABC Limited")
                $ui->toastMessage     = "Welcome, To {$brandName}. Pls, Login";
            } else {
                // Authenticated (forced or real)
                $ui->loginEnabled     = false;
                $ui->logoutEnabled    = true;

                if ($isRegistered) {
                    $ui->editRegVisible  = true;
                    $ui->editRegEnabled  = true;
                } else {
                    $ui->registerVisible = true;
                    $ui->registerEnabled  = true;

                    $ui->toastMessage    = "Pls, Register to access the Menus and Services";
                }
            }

            $view->with(compact('isGuest', 'headerUser', 'menuTree', 'headerCompany', 'ui'));
        });
    }
}



=== END FILE  ===

=== FILE: config/header.php  ===

<?php
// config/header.php

// Forced user id for dev/emulation
$forcedUser = env('HEADER_FORCE_USER_ID');
$forcedUser = is_numeric($forcedUser) ? (int) $forcedUser : null;

// Legacy simulator (kept for early testing)
$forcedReg = env('IS_FORCED_REGISTRATION', false);
$forcedReg = filter_var($forcedReg, FILTER_VALIDATE_BOOLEAN);

// Registration resolver lives here too (so no extra config file needed)
return [
    'dev_force_user_id'    => $forcedUser,   // e.g. 1 or null
    'dev_force_registered' => $forcedReg,    // true/false (simulator)

    'registration' => [
        // 'auto' = use DB if table exists, otherwise fall back to env simulator
        // 'db'   = force DB (if table missing, falls back to env)
        // 'env'  = only env simulator
        'source'         => env('REG_SOURCE', 'auto'),

        'table'          => env('REG_TABLE', null),          // e.g. registration_master
        'user_column'    => env('REG_USER_COLUMN', 'user_id'),
        'company_column' => env('REG_COMPANY_COLUMN', null), // optional: company_id
        'status_column'  => env('REG_STATUS_COLUMN', 'status'),
        'status_active'  => env('REG_STATUS_ACTIVE', '1'),
    ],
];

=== END FILE  ===


=== FILE: resources\views\backend\dashboard\public.blade.php  ===

@extends('backend.layouts.master')

@section('content')
@php
    // Determine brand name from route company param; fallback to global platform
    $brandName = 'ArchReach';
    $param = request()->route('company');
    if ($param instanceof \App\Models\SuperAdmin\GlobalSetup\Company) {
        $brandName = $param->name;
    } elseif (is_string($param) && $param !== '') {
        $row = \Illuminate\Support\Facades\DB::table('companies')
            ->where('slug', $param)
            ->where('status', 1)
            ->whereNull('deleted_at')
            ->first();
        if ($row) {
            $brandName = $row->name;
        }
    }
@endphp

<div class="container py-4">
    <div class="p-4 bg-light border rounded">
        <h1 class="h4 mb-3">Welcome to {{ $brandName }}</h1>
        <p class="mb-3">This is the public landing dashboard.</p>

        <div class="d-flex gap-2 flex-wrap">
            <a href="{{ route('backend.dashboard.index') }}" class="btn btn-primary">Go to Dashboard</a>
            {{-- Placeholder actions until Breeze/auth & registration routes are ready --}}
            <a href="#" class="btn btn-outline-secondary disabled" aria-disabled="true">Login</a>
            <a href="#" class="btn btn-outline-secondary">Register</a>
        </div>
    </div>
</div>
@endsection


=== END FILE  ===



=== FILE: resources\views\backend\dashboard\super-admin\index.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-4">
    <h1 class="h4 mb-3">Super Admin Dashboard</h1>
    <p class="text-muted mb-4">Role type: {{ $roleType ?? 'N/A' }}</p>

    <div class="row g-3">
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="mb-1">Tenants</h6>
                    <div class="display-6">12</div>
                </div>
            </div>
        </div>
        {{-- Add more cards/widgets as needed --}}
    </div>
</div>
@endsection


=== END FILE  ===

=== FILE: resources\views\backend\dashboard\ceo\index.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-4">
    <h1 class="h4 mb-3">CEO Dashboard</h1>
    <p class="text-muted mb-4">Role type: {{ $roleType ?? 'N/A' }}</p>
    {{-- CEO-specific cards go here --}}
</div>
@endsection

=== END FILE  ===


=== FILE: resources\views\backend\dashboard\zonal-admin\index.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-4">
    <h1 class="h4 mb-3">Zonal Admin Dashboard</h1>
    <p class="text-muted mb-4">Role type: {{ $roleType ?? 'N/A' }}</p>
    {{-- Zonal-specific cards go here --}}
</div>
@endsection

=== END FILE  ===

=== FILE: resources\views\backend\layouts\master.blade.php  ===

{{-- backend/layouts/master.blade.php --}}
<!DOCTYPE html>
<html lang="en">
<head>
  @include('backend.layouts.partials.head')   {{-- Bootstrap 5, Font Awesome, Tom Select + @stack('styles') --}}
</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

  @include('backend.layouts.partials.header')   {{-- logo, search, contact/about/complain, registration link --}}
  @include('backend.layouts.partials.sidebar')  {{-- dynamic role-based menu --}}

  <main class="content-wrapper">
    @include('backend.layouts.partials.alerts') {{-- toasts/flash --}}
    @yield('content')
  </main>

  @include('backend.layouts.partials.footer')

  {{-- Optional control sidebar if ever needed in future. --}}
  {{-- <aside class="control-sidebar control-sidebar-dark"></aside> --}}

</div>

@include('backend.layouts.partials.scripts')     {{-- jQuery, Bootstrap bundle, Tom Select + @stack('scripts') --}}
</body>
</html>

=== END FILE  ===


=== FILE: resources\views\backend\layouts\partials\head.blade.php  ===


{{-- backend/layouts/partials/head.blade.php --}}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="csrf-token" content="{{ csrf_token() }}">

<title>{{ $title ?? 'Trimatric SaaS' }}</title>

{{-- Bootstrap 5 --}}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

{{-- Font Awesome --}}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

{{-- Tom Select --}}
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet"/>

@stack('styles')


=== END FILE  ===



=== FILE: resources\views\backend\layouts\partials\header.blade.php  ===

{{-- resources/views/backend/layouts/partials/header.blade.php --}}
<header class="border-bottom bg-white">
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">

            {{-- Brand / logo (tenant if available, else platform). Keep public context in the link. --}}
            @php
                $brandName = $headerCompany->name ?? 'ArchReach';
                $brandLogo = $headerCompany->logo ?? null;
                $brandHref = $headerCompany
                    ? route('backend.company.dashboard.public', ['company' => $headerCompany->slug])
                    : route('backend.dashboard.public');
            @endphp

            <a class="navbar-brand d-flex align-items-center gap-2" href="{{ $brandHref }}">
                @if($brandLogo)
                    <img src="{{ asset($brandLogo) }}" alt="Logo" width="36" height="36" class="rounded" style="object-fit:cover;">
                @else
                    <img src="{{ asset('assets/images/trimatric_logo.png') }}" alt="Logo" width="36" height="36" class="rounded">
                @endif
                <span class="fw-semibold">{{ $brandName }}</span>
            </a>

            {{-- Mobile toggler --}}
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                    aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            {{-- Collapsible content --}}
            <div class="collapse navbar-collapse" id="mainNavbar">

                {{-- LEFT: role menus (none for guests; provider already returns empty). --}}
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    @foreach($menuTree as $node)
                        @php $hasChildren = !empty($node->children) && count($node->children) > 0; @endphp

                        @if($hasChildren)
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle d-flex align-items-center gap-2"
                                   href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    @if(!empty($node->icon)) <i class="{{ $node->icon }}"></i> @endif
                                    <span>{{ $node->name }}</span>
                                </a>
                                <ul class="dropdown-menu">
                                    @foreach($node->children as $child)
                                        <li>
                                            <a class="dropdown-item d-flex align-items-center gap-2" href="{{ $child->url }}">
                                                @if(!empty($child->icon)) <i class="{{ $child->icon }}"></i> @endif
                                                <span>{{ $child->name }}</span>
                                            </a>
                                        </li>
                                    @endforeach
                                </ul>
                            </li>
                        @else
                            <li class="nav-item">
                                <a class="nav-link d-flex align-items-center gap-2" href="{{ $node->url }}">
                                    @if(!empty($node->icon)) <i class="{{ $node->icon }}"></i> @endif
                                    <span>{{ $node->name }}</span>
                                </a>
                            </li>
                        @endif
                    @endforeach
                </ul>

                {{-- CENTER: simple search placeholder --}}
                <form class="d-flex mx-lg-3 flex-grow-1 my-2 my-lg-0" role="search" method="GET" action="#">
                    <input class="form-control" type="search" name="q" placeholder="Search…" aria-label="Search">
                </form>

                {{-- RIGHT: registration buttons + auth menu --}}
                <ul class="navbar-nav ms-lg-2 mb-2 mb-lg-0 align-items-lg-center">

                    {{-- Dev badge when forcing user id --}}
                    @php $forcedId = config('header.dev_force_user_id'); @endphp
                    @if($forcedId)
                        <li class="nav-item me-lg-2">
                            <span class="badge text-bg-warning" title="Dev forced user id">User Id #{{ $forcedId }}</span>
                        </li>
                    @endif

                    {{-- Registration / Edit Registration (only one shows at a time) --}}
                    @if(!empty($ui->registerVisible) || !empty($ui->editRegVisible))
                        <li class="nav-item me-lg-1">
                            @if(!empty($ui->editRegVisible) && !empty($ui->editRegEnabled))
                                {{-- Edit Registration (enabled) --}}
                                @if(Route::has('registration.edit'))
                                    <a class="btn btn-sm btn-outline-primary" href="{{ route('registration.edit') }}">
                                        <i class="fa-solid fa-pen-to-square me-1"></i> Edit Registration
                                    </a>
                                @else
                                    <a class="btn btn-sm btn-outline-primary" href="#" title="Edit registration">
                                        <i class="fa-solid fa-pen-to-square me-1"></i> Edit Registration
                                    </a>
                                @endif
                            @elseif(!empty($ui->registerVisible) && !empty($ui->registerEnabled))
                                {{-- Register (enabled) --}}
                                @if(Route::has('registration.start'))
                                    <a class="btn btn-sm btn-primary" href="{{ route('registration.start') }}">
                                        <i class="fa-solid fa-user-plus me-1"></i> Register
                                    </a>
                                @elseif(Route::has('registration.create'))
                                    <a class="btn btn-sm btn-primary" href="{{ route('registration.create') }}">
                                        <i class="fa-solid fa-user-plus me-1"></i> Register
                                    </a>
                                @else
                                    <a class="btn btn-sm btn-primary" href="#" title="Start registration">
                                        <i class="fa-solid fa-user-plus me-1"></i> Register
                                    </a>
                                @endif
                            @elseif(!empty($ui->registerVisible) && empty($ui->registerEnabled))
                                {{-- Register (visible but disabled for guests) --}}
                                <span class="btn btn-sm btn-outline-secondary disabled" aria-disabled="true" tabindex="-1"
                                      title="Please login to register">
                                    <i class="fa-solid fa-user-plus me-1"></i> Register
                                </span>
                            @endif
                        </li>
                    @endif

                    {{-- Guest auth links (Login enabled, Logout disabled) --}}
                    @if(!empty($ui->loginVisible) && $ui->loginEnabled && $isGuest)
                        <li class="nav-item">
                            @if(Route::has('login'))
                                <a class="nav-link" href="{{ route('login') }}">
                                    <i class="fa-solid fa-right-to-bracket me-1"></i> Login
                                </a>
                            @else
                                <a class="nav-link" href="#">
                                    <i class="fa-solid fa-right-to-bracket me-1"></i> Login
                                </a>
                            @endif
                        </li>
                        <li class="nav-item">
                            <span class="nav-link disabled" aria-disabled="true" tabindex="-1" title="Logout requires auth">
                                <i class="fa-solid fa-right-from-bracket me-1"></i> Logout
                            </span>
                        </li>
                    @endif

                    {{-- Authenticated (or forced) user dropdown --}}
                    @if(!$isGuest)
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fa-solid fa-circle-user"></i>
                                <span>{{ $headerUser->name ?? 'User' }}</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#"><i class="fa-solid fa-id-badge me-2"></i>Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="fa-solid fa-gear me-2"></i>Settings</a></li>
                                <li><hr class="dropdown-divider"></li>

                                {{-- Show Login in dropdown but disabled when authenticated --}}
                                @if(!empty($ui->loginVisible) && empty($ui->loginEnabled))
                                    <li>
                                        <span class="dropdown-item disabled" aria-disabled="true" tabindex="-1">
                                            <i class="fa-solid fa-right-to-bracket me-2"></i>Login
                                        </span>
                                    </li>
                                @endif

                                {{-- Logout (enabled for forced or real auth per requirement) --}}
                                @if(!empty($ui->logoutVisible) && !empty($ui->logoutEnabled))
                                    <li>
                                        @if(Route::has('logout'))
                                            <form method="POST" action="{{ route('logout') }}" class="px-3">
                                                @csrf
                                                <button type="submit" class="btn btn-link p-0 text-start">
                                                    <i class="fa-solid fa-right-from-bracket me-2"></i>Logout
                                                </button>
                                            </form>
                                        @else
                                            <a class="dropdown-item" href="#">
                                                <i class="fa-solid fa-right-from-bracket me-2"></i>Logout
                                            </a>
                                        @endif
                                    </li>
                                @else
                                    <li>
                                        <span class="dropdown-item disabled" aria-disabled="true" tabindex="-1">
                                            <i class="fa-solid fa-right-from-bracket me-2"></i>Logout
                                        </span>
                                    </li>
                                @endif
                            </ul>
                        </li>
                    @endif
                </ul>
            </div>
        </div>
    </nav>

    {{-- Simple toast (Bootstrap 5). 
        Green for: 
        • Guest "Welcome" message, and 
        • Authenticated but NOT registered ("Pls, Register...") message.
        Logic: use $isGuest OR the provider’s UI flags (registerVisible = true).
    --}}
    @if(!empty($ui->toastMessage))
        @php
            // Green when guest, or when registration is required
            $makeGreen = $isGuest || (!empty($ui->registerVisible));
        @endphp
        <div class="position-fixed top-0 end-0 p-3" style="z-index: 1080;">
            <div class="toast show {{ $makeGreen ? 'text-bg-success' : '' }}" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-body">
                    {{ $ui->toastMessage }}
                </div>
            </div>
        </div>
    @endif


</header>


=== END FILE  ===


=== FILE: resources\views\backend\layouts\partials\scripts.blade.php  ===

{{-- backend/layouts/partials/scripts.blade.php --}}

{{-- Core JS libraries (always loaded) --}}
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

{{-- Toast auto-show --}}
<script>
    document.querySelectorAll('.toast').forEach(t => new bootstrap.Toast(t).show());
</script>

{{-- Page-specific scripts --}}
@stack('scripts')


=== END FILE  ===


=== FILE: resources\views\backend\modules\global-setup\companies\index.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-3 py-md-4">

    {{-- Flash toasts (keep simple; master may also auto-show toasts) --}}
    @if(session('status'))
        <div class="alert alert-success d-flex align-items-center" role="alert">
            <i class="fa fa-check-circle me-2"></i> {{ session('status') }}
        </div>
    @endif
    @if(session('error'))
        <div class="alert alert-danger d-flex align-items-center" role="alert">
            <i class="fa fa-triangle-exclamation me-2"></i> {{ session('error') }}
        </div>
    @endif

    <div class="bg-white rounded-3 border p-3">
        {{-- Header --}}
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2">
            <div>
                <h1 class="h4 mb-1">Companies</h1>
                <div class="text-muted">Manage companies (Super Admin)</div>
            </div>

            <div class="d-flex align-items-center gap-2">
                @if(!empty($can['create']))
                    <a href="{{ route('superadmin.globalsetup.companies.create') }}" class="btn btn-primary">
                        <i class="fa fa-plus"></i> Add Company
                    </a>
                @endif
            </div>
        </div>

        {{-- Controls --}}
        @php $s = $sort ?? 'id'; $d = $dir ?? 'desc'; @endphp
        <form method="GET" action="{{ route('superadmin.globalsetup.companies.index') }}" class="mt-3">
            <div class="d-flex flex-column flex-md-row align-items-stretch align-items-md-center gap-2">
                <div class="ms-md-auto flex-grow-1">
                    <input type="search" name="search" class="form-control"
                           value="{{ $search }}" placeholder="Search company or country..." />
                </div>

                <div class="d-flex gap-2">
                    <select name="sort" class="form-select" onchange="this.form.submit()">
                        <option value="id"         {{ $s==='id' ? 'selected' : '' }}>ID</option>
                        <option value="name"       {{ $s==='name' ? 'selected' : '' }}>Name</option>
                        <option value="status"     {{ $s==='status' ? 'selected' : '' }}>Status</option>
                        <option value="created_at" {{ $s==='created_at' ? 'selected' : '' }}>Created</option>
                    </select>
                    <select name="dir" class="form-select" onchange="this.form.submit()">
                        <option value="asc"  {{ $d==='asc'  ? 'selected' : '' }}>Asc</option>
                        <option value="desc" {{ $d==='desc' ? 'selected' : '' }}>Desc</option>
                    </select>
                </div>

                <div>
                    <select name="limit" class="form-select" onchange="this.form.submit()">
                        @foreach ([10,25,50,100] as $opt)
                            <option value="{{ $opt }}" {{ (int)$limit === $opt ? 'selected' : '' }}>{{ $opt }} / page</option>
                        @endforeach
                    </select>
                </div>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-outline-primary"><i class="fa fa-search"></i> Go</button>
                    @if($search !== '')
                        <a href="{{ route('superadmin.globalsetup.companies.index', ['limit' => $limit, 'sort' => $s, 'dir' => $d]) }}"
                           class="btn btn-outline-secondary">Reset</a>
                    @endif
                </div>
            </div>
        </form>

        {{-- Table --}}
        <div class="mt-3 border rounded overflow-hidden">
            <div class="table-responsive">
                <table class="table table-bordered table-hover align-middle mb-0">
                    <thead class="table-dark">
                        <tr>
                            <th class="text-center" style="width:70px;">ID</th>
                            <th>Logo</th>
                            <th>Name</th>
                            <th>Country</th>
                            <th class="text-center">Status</th>
                            <th>Created</th>
                            <th class="text-center" style="width:240px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    @forelse ($rows as $row)
                        <tr id="row-{{ $row->id }}">
                            <td class="text-center">#{{ $row->id }}</td>
                            <td>
                                @if(!empty($row->logo))
                                    <img src="{{ asset($row->logo) }}" alt="Logo" class="img-thumbnail" style="max-height:48px">
                                @else
                                    <span class="text-muted">—</span>
                                @endif
                            </td>
                            <td>{{ $row->name }}</td>
                            <td>{{ $row->country_name }}</td>
                            <td class="text-center">
                                @if((int)$row->status === 1)
                                    <span class="badge bg-success">Active</span>
                                @else
                                    <span class="badge bg-secondary">Inactive</span>
                                @endif
                            </td>
                            <td>{{ \Illuminate\Support\Carbon::parse($row->created_at)->format('Y-m-d H:i') }}</td>
                            <td class="text-center">
                                <div class="d-flex gap-2 flex-wrap justify-content-center">
                                    @if(!empty($can['view']))
                                        <a href="{{ route('superadmin.globalsetup.companies.show', $row->id) }}" class="btn btn-sm btn-info">
                                            <i class="fa fa-eye"></i> View
                                        </a>
                                    @endif
                                    @if(!empty($can['edit']))
                                        <a href="{{ route('superadmin.globalsetup.companies.edit', $row->id) }}" class="btn btn-sm btn-warning">
                                            <i class="fa fa-pen"></i> Edit
                                        </a>
                                    @endif
                                    @if(!empty($can['delete']))
                                        <button type="button" class="btn btn-sm btn-danger btn-delete"
                                                data-id="{{ $row->id }}"
                                                data-name="{{ $row->name }}"
                                                data-url="{{ route('superadmin.globalsetup.companies.destroy', $row->id) }}">
                                            <i class="fa fa-trash"></i> Delete
                                        </button>
                                    @endif
                                </div>
                            </td>
                        </tr>
                    @empty
                        <tr><td colspan="7" class="text-center text-muted py-4">No records found.</td></tr>
                    @endforelse
                    </tbody>
                </table>
            </div>
        </div>

        {{-- Pagination --}}
        @php
          $q = ['search'=>$search,'limit'=>$limit,'sort'=>$sort ?? 'id','dir'=>$dir ?? 'desc'];
        @endphp
        <nav class="mt-3">
            <ul class="pagination justify-content-center">
                <li class="page-item {{ $page <= 1 ? 'disabled' : '' }}">
                    <a class="page-link" href="{{ $page <= 1 ? '#' : route('superadmin.globalsetup.companies.index', array_merge($q, ['page' => $page-1])) }}">Previous</a>
                </li>

                @if($winStart > 1)
                    <li class="page-item disabled"><span class="page-link">…</span></li>
                @endif

                @for($i = $winStart; $i <= $winEnd; $i++)
                    <li class="page-item {{ $i === $page ? 'active' : '' }}">
                        <a class="page-link" href="{{ route('superadmin.globalsetup.companies.index', array_merge($q, ['page' => $i])) }}">{{ $i }}</a>
                    </li>
                @endfor

                @if($winEnd < $totalPages)
                    <li class="page-item disabled"><span class="page-link">…</span></li>
                @endif

                <li class="page-item {{ $page >= $totalPages ? 'disabled' : '' }}">
                    <a class="page-link" href="{{ $page >= $totalPages ? '#' : route('superadmin.globalsetup.companies.index', array_merge($q, ['page' => $page+1])) }}">Next</a>
                </li>
            </ul>

            <div class="text-center text-muted mt-1">
                Showing page <strong>{{ $page }}</strong> of <strong>{{ $totalPages }}</strong>,
                total <strong>{{ number_format($total) }}</strong> record(s).
            </div>
        </nav>
    </div>
</div>

{{-- Delete modal --}}
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered"><div class="modal-content">
    <div class="modal-header bg-danger text-white">
      <h5 class="modal-title" id="deleteModalLabel"><i class="fa fa-triangle-exclamation me-1"></i> Confirm Delete</h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      Are you sure you want to delete <strong id="deleteName">this record</strong>?
      <div class="small text-muted mt-1">This is a soft delete; you can restore later.</div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
      <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
        <i class="fa fa-trash"></i> Delete
      </button>
    </div>
  </div></div>
</div>
@endsection

@push('scripts')
<script>
$.ajaxSetup({
  headers: { 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content') }
});

let deleteTarget = { id: null, url: null };

$(function () {
  const $deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
  const $deleteName  = $('#deleteName');

  $(document).on('click', '.btn-delete', function () {
    deleteTarget.id  = $(this).data('id');
    deleteTarget.url = $(this).data('url');
    const name       = $(this).data('name') || ('#' + deleteTarget.id);
    $deleteName.text(name);
    $deleteModal.show();
  });

  $('#confirmDeleteBtn').on('click', function () {
    if (!deleteTarget.url) return;

    $.ajax({
      url: deleteTarget.url,
      type: 'POST',
      data: { _method: 'DELETE' },
      dataType: 'json',
      success: function (res) {
        if (res && res.ok) {
          $('#row-' + deleteTarget.id).fadeOut(200, function(){ $(this).remove(); });
        } else {
          alert(res?.message || 'Delete failed. Please try again.');
        }
        deleteTarget = { id: null, url: null };
        $deleteModal.hide();
      },
      error: function (xhr) {
        if (xhr.status === 403)      alert('Forbidden: you do not have permission.');
        else if (xhr.status === 404) alert('Record not found or already deleted.');
        else                         alert('Server error while deleting.');
        deleteTarget = { id: null, url: null };
        $deleteModal.hide();
      }
    });
  });
});
</script>
@endpush


=== END FILE  ===



=== FILE: resources\views\backend\modules\global-setup\companies\create.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-3 py-md-4">
    <div class="bg-white rounded-3 border p-3">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 mb-3">
            <h1 class="h4 mb-0">Add Company</h1>
            <a href="{{ route('superadmin.globalsetup.companies.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        @if ($errors->any())
            <div class="alert alert-danger">
                <strong>Please fix the following:</strong>
                <ul class="mb-0">
                    @foreach ($errors->all() as $err)
                        <li>{{ $err }}</li>
                    @endforeach
                </ul>
            </div>
        @endif

        <form method="POST" action="{{ route('superadmin.globalsetup.companies.store') }}" class="row g-3" enctype="multipart/form-data">
            @csrf

            <div class="col-md-4">
                <label class="form-label">Country <span class="text-danger">*</span></label>
                <select name="country_id" class="form-select @error('country_id') is-invalid @enderror" required>
                    <option value="">-- Select --</option>
                    @foreach($countries as $c)
                        <option value="{{ $c->id }}" {{ old('country_id')==$c->id?'selected':'' }}>{{ $c->name }}</option>
                    @endforeach
                </select>
                @error('country_id') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Company Name <span class="text-danger">*</span></label>
                <input name="name" type="text" class="form-control @error('name') is-invalid @enderror"
                       value="{{ old('name') }}" maxlength="190" required>
                @error('name') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-2">
                <label class="form-label">Status <span class="text-danger">*</span></label>
                <select name="status" class="form-select @error('status') is-invalid @enderror" required>
                    <option value="1" {{ old('status','1')=='1'?'selected':'' }}>Active</option>
                    <option value="0" {{ old('status')==='0'?'selected':'' }}>Inactive</option>
                </select>
                @error('status') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Logo</label>
                <input name="logo" type="file" class="form-control @error('logo') is-invalid @enderror" accept=".jpg,.jpeg,.png,.webp">
                <div class="form-text">JPG/PNG/WEBP, max 2MB.</div>
                @error('logo') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Contact No</label>
                <input name="contact_no" type="text" class="form-control @error('contact_no') is-invalid @enderror" value="{{ old('contact_no') }}" maxlength="50">
                @error('contact_no') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Address</label>
                <input name="address" type="text" class="form-control @error('address') is-invalid @enderror" value="{{ old('address') }}" maxlength="500">
                @error('address') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Description</label>
                <textarea name="description" class="form-control @error('description') is-invalid @enderror" rows="3" maxlength="1000">{{ old('description') }}</textarea>
                @error('description') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-12 mt-2">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-save"></i> Save
                </button>
                <a href="{{ route('superadmin.globalsetup.companies.index') }}" class="btn btn-secondary">Return</a>
            </div>
        </form>
    </div>
</div>
@endsection

=== END FILE  ===



=== FILE: resources\views\backend\modules\global-setup\companies\edit.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-3 py-md-4">
    <div class="bg-white rounded-3 border p-3">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 mb-3">
            <h1 class="h4 mb-0">Edit Company <small class="text-muted">#{{ $company->id }}</small></h1>
            <a href="{{ route('superadmin.globalsetup.companies.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        @if ($errors->any())
            <div class="alert alert-danger">
                <strong>Please fix the following:</strong>
                <ul class="mb-0">
                    @foreach ($errors->all() as $err)
                        <li>{{ $err }}</li>
                    @endforeach
                </ul>
            </div>
        @endif

        <form method="POST" action="{{ route('superadmin.globalsetup.companies.update', $company->id) }}" class="row g-3" enctype="multipart/form-data">
            @csrf @method('PUT')

            <div class="col-md-4">
                <label class="form-label">Country <span class="text-danger">*</span></label>
                <select name="country_id" class="form-select @error('country_id') is-invalid @enderror" required>
                    <option value="">-- Select --</option>
                    @foreach($countries as $c)
                        <option value="{{ $c->id }}" {{ old('country_id', $company->country_id)==$c->id?'selected':'' }}>{{ $c->name }}</option>
                    @endforeach
                </select>
                @error('country_id') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Company Name <span class="text-danger">*</span></label>
                <input name="name" type="text" class="form-control @error('name') is-invalid @enderror"
                       value="{{ old('name', $company->name) }}" maxlength="190" required>
                @error('name') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-2">
                <label class="form-label">Status <span class="text-danger">*</span></label>
                <select name="status" class="form-select @error('status') is-invalid @enderror" required>
                    <option value="1" {{ old('status', (string)$company->status)=='1'?'selected':'' }}>Active</option>
                    <option value="0" {{ old('status', (string)$company->status)=='0'?'selected':'' }}>Inactive</option>
                </select>
                @error('status') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Logo</label>
                <input name="logo" type="file" class="form-control @error('logo') is-invalid @enderror" accept=".jpg,.jpeg,.png,.webp">
                <div class="form-text">JPG/PNG/WEBP, max 2MB.</div>
                @error('logo') <div class="invalid-feedback">{{ $message }}</div> @enderror

                @if($company->logo)
                    <div class="mt-2">
                        <img src="{{ asset($company->logo) }}" alt="Logo" class="img-thumbnail" style="max-height:80px">
                    </div>
                @endif
            </div>

            <div class="col-md-6">
                <label class="form-label">Contact No</label>
                <input name="contact_no" type="text" class="form-control @error('contact_no') is-invalid @enderror"
                       value="{{ old('contact_no', $company->contact_no) }}" maxlength="50">
                @error('contact_no') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Address</label>
                <input name="address" type="text" class="form-control @error('address') is-invalid @enderror"
                       value="{{ old('address', $company->address) }}" maxlength="500">
                @error('address') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-6">
                <label class="form-label">Description</label>
                <textarea name="description" class="form-control @error('description') is-invalid @enderror" rows="3" maxlength="1000">{{ old('description', $company->description) }}</textarea>
                @error('description') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-12 mt-2">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-save"></i> Save
                </button>
                <a href="{{ route('superadmin.globalsetup.companies.index') }}" class="btn btn-secondary">Return</a>
            </div>
        </form>
    </div>
</div>
@endsection

=== END FILE  ===


=== FILE: resources\views\backend\modules\global-setup\companies\show.blade.php  ===

@extends('backend.layouts.master')

@section('content')
<div class="container py-3 py-md-4">
    <div class="bg-white rounded-3 border p-3">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 mb-3">
            <h1 class="h4 mb-0">View Company <small class="text-muted">#{{ $company->id }}</small></h1>
            <a href="{{ route('superadmin.globalsetup.companies.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        <div class="row g-3">
            <div class="col-md-6">
                <div class="border rounded p-3 bg-light">
                    <div class="mb-2"><strong>Name:</strong> {{ $company->name }}</div>
                    <div class="mb-2"><strong>Country:</strong> {{ $country }}</div>
                    <div class="mb-2">
                        <strong>Status:</strong>
                        @if((int)$company->status === 1)
                            <span class="badge bg-success">Active</span>
                        @else
                            <span class="badge bg-secondary">Inactive</span>
                        @endif
                    </div>
                    <div class="mb-2"><strong>Contact No:</strong> {{ $company->contact_no ?? '—' }}</div>
                    <div class="mb-2"><strong>Address:</strong> {{ $company->address ?? '—' }}</div>
                    <div class="mb-2"><strong>Description:</strong> {{ $company->description ?? '—' }}</div>
                    <div class="mb-2"><strong>Created:</strong> {{ $company->created_at?->format('Y-m-d H:i') ?? '—' }}</div>
                    <div class="mb-2"><strong>Updated:</strong> {{ $company->updated_at?->format('Y-m-d H:i') ?? '—' }}</div>
                </div>
            </div>
            <div class="col-md-6">
                @if($company->logo)
                    <div class="border rounded p-3 h-100 d-flex align-items-center justify-content-center">
                        <img src="{{ asset($company->logo) }}" alt="Logo" class="img-fluid" style="max-height:160px">
                    </div>
                @else
                    <div class="border rounded p-3 h-100 d-flex align-items-center justify-content-center text-muted">No logo</div>
                @endif
            </div>
        </div>
    </div>
</div>
@endsection


=== END FILE  ===

=== FILE: resources\views\backend\modules\global-setup\countries\index.blade.php  ===

{{-- resources/views/backend/modules/global-setup/countries/index.blade.php --}}
@extends('backend.layouts.master')

@push('styles')
    <style>
        body { background: #f6f8fa; color: #12203a; }
        .page-card { background:#fff; border-radius:14px; box-shadow:0 6px 28px rgba(0,0,0,.06); padding:1rem 1rem 1.25rem; border:1px solid #e6ecf5; }
        .page-title { font-size:1.35rem; font-weight:700; margin:0; letter-spacing:.2px; }
        .subtle { font-size:.9rem; color:#5a6a85; }
        .table-wrap { margin-top:.8rem; border:1px solid #e6ecf5; border-radius:12px; overflow:hidden; }
        .table-responsive { max-height:62vh; overflow:auto; }
        .table-striped tbody tr:nth-of-type(odd){ background-color:#f7fbff !important; }
        .table-hover tbody tr:hover{ background-color:#eaf2ff !important; }
        .table td, .table th { vertical-align:middle; }
        .pagination .page-link{ border-radius:.5rem; }
        .pagination .page-item.active .page-link{ background-color:#2e6dda; border-color:#2e6dda; }
        .toast-container{ position:fixed; top:1rem; right:1rem; z-index:1060; }
    </style>
@endpush

@section('content')
<div class="container py-3 py-md-4">
    {{-- Toasts --}}
    <div class="toast-container">
        @if(session('status'))
            <div class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="2500">
                <div class="d-flex">
                    <div class="toast-body"><i class="fa fa-check-circle me-1"></i> {{ session('status') }}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
            </div>
        @endif
        @if(session('error'))
            <div class="toast align-items-center text-bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">
                <div class="d-flex">
                    <div class="toast-body"><i class="fa fa-triangle-exclamation me-1"></i> {{ session('error') }}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
            </div>
        @endif
    </div>

    <div class="page-card">
        {{-- Header --}}
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
            <div>
                <h1 class="page-title">Countries</h1>
                <div class="subtle">Manage country records (Super Admin)</div>
            </div>

            <div class="d-flex gap-2 align-items-center">
                <div class="dropdown">
                    <button class="btn btn-outline-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fa fa-ellipsis"></i> More
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><button class="dropdown-item" type="button" disabled>Export CSV (coming)</button></li>
                        <li><button class="dropdown-item" type="button" disabled>Column visibility (coming)</button></li>
                        <li><hr class="dropdown-divider"/></li>
                        <li><button class="dropdown-item text-danger" type="button" disabled>Bulk Delete (coming)</button></li>
                    </ul>
                </div>

                @if(!empty($can['create']))
                    <a href="{{ route('superadmin.globalsetup.countries.create') }}" class="btn btn-primary">
                        <i class="fa fa-plus"></i> Add Country
                    </a>
                @endif
            </div>
        </div>

        {{-- Controls (Bootstrap-only layout) --}}
        <form method="GET" action="{{ route('superadmin.globalsetup.countries.index') }}" class="mt-3">
            @php $s = $sort ?? 'id'; $d = $dir ?? 'desc'; @endphp
            <div class="d-flex flex-column flex-md-row align-items-stretch align-items-md-center gap-2">

                {{-- Search (full width on mobile) --}}
                <div class="flex-grow-1">
                    <input type="search" name="search" class="form-control"
                           value="{{ $search }}" placeholder="Search country name or short code..." />
                </div>

                {{-- Sort & direction --}}
                <div class="d-flex gap-2">
                    <select name="sort" class="form-select" onchange="this.form.submit()">
                        <option value="id"         {{ $s==='id' ? 'selected' : '' }}>ID</option>
                        <option value="name"       {{ $s==='name' ? 'selected' : '' }}>Name</option>
                        <option value="short_code" {{ $s==='short_code' ? 'selected' : '' }}>Short Code</option>
                        <option value="created_at" {{ $s==='created_at' ? 'selected' : '' }}>Created</option>
                    </select>

                    <select name="dir" class="form-select" onchange="this.form.submit()">
                        <option value="asc"  {{ $d==='asc'  ? 'selected' : '' }}>Asc</option>
                        <option value="desc" {{ $d==='desc' ? 'selected' : '' }}>Desc</option>
                    </select>
                </div>

                {{-- Limit --}}
                <div>
                    <select name="limit" class="form-select" onchange="this.form.submit()">
                        @foreach ([10,25,50,100] as $opt)
                            <option value="{{ $opt }}" {{ (int)$limit === $opt ? 'selected' : '' }}>{{ $opt }} / page</option>
                        @endforeach
                    </select>
                </div>

                {{-- Buttons --}}
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-outline-primary">
                        <i class="fa fa-search"></i> Go
                    </button>
                    @if($search !== '')
                        <a href="{{ route('superadmin.globalsetup.countries.index', ['limit' => $limit, 'sort' => $s, 'dir' => $d]) }}"
                           class="btn btn-outline-secondary">Reset</a>
                    @endif
                </div>
            </div>
        </form>

        {{-- Table --}}
        <div class="table-wrap">
            <div class="table-responsive">
                <table class="table table-bordered table-hover table-striped align-middle mb-0">
                    <thead class="table-dark">
                        <tr>
                            <th class="text-center">ID</th>
                            <th>Name</th>
                            <th class="text-center">Short Code</th>
                            <th>Created</th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    @forelse ($rows as $row)
                        <tr id="row-{{ $row->id }}">
                            <td data-label="ID" class="text-center">#{{ $row->id }}</td>
                            <td data-label="Name">{{ $row->name }}</td>
                            <td data-label="Short Code" class="text-center">{{ $row->short_code ?? '—' }}</td>
                            <td data-label="Created">{{ \Illuminate\Support\Carbon::parse($row->created_at)->format('Y-m-d H:i') }}</td>
                            <td class="row-actions text-center" data-label="Actions">
                                <div class="d-flex gap-2 flex-wrap justify-content-center">
                                    @if(!empty($can['view']))
                                        <a href="{{ route('superadmin.globalsetup.countries.show', $row->id) }}" class="btn btn-sm btn-info">
                                            <i class="fa fa-eye"></i> View
                                        </a>
                                    @endif
                                    @if(!empty($can['edit']))
                                        <a href="{{ route('superadmin.globalsetup.countries.edit', $row->id) }}" class="btn btn-sm btn-warning">
                                            <i class="fa fa-pen"></i> Edit
                                        </a>
                                    @endif
                                    @if(!empty($can['delete']))
                                        <button type="button" class="btn btn-sm btn-danger btn-delete"
                                                data-id="{{ $row->id }}"
                                                data-name="{{ $row->name }}"
                                                data-url="{{ route('superadmin.globalsetup.countries.destroy', $row->id) }}">
                                            <i class="fa fa-trash"></i> Delete
                                        </button>
                                    @endif
                                </div>
                            </td>
                        </tr>
                    @empty
                        <tr><td colspan="5" class="text-center text-muted py-4">No records found.</td></tr>
                    @endforelse
                    </tbody>
                </table>
            </div>
        </div>

        {{-- Pagination --}}
        @php
          $q = [
            'search' => $search,
            'limit'  => $limit,
            'sort'   => $sort ?? 'id',
            'dir'    => $dir  ?? 'desc'
          ];
        @endphp
        <nav class="mt-3">
            <ul class="pagination justify-content-center">
                <li class="page-item {{ $page <= 1 ? 'disabled' : '' }}">
                    <a class="page-link" href="{{ $page <= 1 ? '#' : route('superadmin.globalsetup.countries.index', array_merge($q, ['page' => $page-1])) }}">Previous</a>
                </li>

                @if($winStart > 1)
                    <li class="page-item disabled"><span class="page-link">…</span></li>
                @endif

                @for($i = $winStart; $i <= $winEnd; $i++)
                    <li class="page-item {{ $i === $page ? 'active' : '' }}">
                        <a class="page-link" href="{{ route('superadmin.globalsetup.countries.index', array_merge($q, ['page' => $i])) }}">{{ $i }}</a>
                    </li>
                @endfor

                @if($winEnd < $totalPages)
                    <li class="page-item disabled"><span class="page-link">…</span></li>
                @endif

                <li class="page-item {{ $page >= $totalPages ? 'disabled' : '' }}">
                    <a class="page-link" href="{{ $page >= $totalPages ? '#' : route('superadmin.globalsetup.countries.index', array_merge($q, ['page' => $page+1])) }}">Next</a>
                </li>
            </ul>

            <div class="text-center subtle mt-1">
                Showing page <strong>{{ $page }}</strong> of <strong>{{ $totalPages }}</strong>,
                total <strong>{{ number_format($total) }}</strong> record(s).
            </div>
        </nav>
    </div>
</div>

{{-- Delete Confirm Modal --}}
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="deleteModalLabel"><i class="fa fa-triangle-exclamation me-1"></i> Confirm Delete</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete <strong id="deleteName">this record</strong>?
        <div class="small text-muted mt-1">This is a soft delete; you can restore later.</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
          <i class="fa fa-trash"></i> Delete
        </button>
      </div>
    </div>
  </div>
</div>
@endsection

@push('scripts')
<script>
$.ajaxSetup({
  headers: { 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content') }
});

let deleteTarget = { id: null, url: null };

$(function () {
  const $deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
  const $deleteName  = $('#deleteName');

  $(document).on('click', '.btn-delete', function () {
    deleteTarget.id  = $(this).data('id');
    deleteTarget.url = $(this).data('url');
    const name       = $(this).data('name') || ('#' + deleteTarget.id);
    $deleteName.text(name);
    $deleteModal.show();
  });

  $('#confirmDeleteBtn').on('click', function () {
    if (!deleteTarget.url) return;

    $.ajax({
      url: deleteTarget.url,
      type: 'POST',
      data: { _method: 'DELETE' },
      dataType: 'json',
      success: function (res) {
        if (res && res.ok) {
          $('#row-' + deleteTarget.id).fadeOut(200, function(){ $(this).remove(); });
        } else {
          alert(res?.message || 'Delete failed. Please try again.');
        }
        deleteTarget = { id: null, url: null };
        $deleteModal.hide();
      },
      error: function (xhr) {
        if (xhr.status === 403)      alert('Forbidden: you do not have permission.');
        else if (xhr.status === 404) alert('Record not found or already deleted.');
        else                         alert('Server error while deleting.');
        deleteTarget = { id: null, url: null };
        $deleteModal.hide();
      }
    });
  });
});
</script>
@endpush

=== END FILE  ===



=== FILE: resources\views\backend\modules\global-setup\countries\create.blade.php  ===

{{-- resources/views/backend/modules/global-setup/countries/create.blade.php --}}
@extends('backend.layouts.master')

@push('styles')
    <style>
        body { background: #f6f8fa; }
        .page-card { background:#fff; border-radius:14px; box-shadow:0 6px 28px rgba(0,0,0,.06); padding:1rem 1rem 1.25rem; border:1px solid #e6ecf5; }
        .page-title { font-size:1.35rem; font-weight:700; margin:0; letter-spacing:.2px; }
        .alert ul { margin-bottom: 0; }
    </style>
@endpush

@section('content')
<div class="container py-3 py-md-4">
    <div class="page-card">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
            <h1 class="page-title mb-0">Add Country</h1>
            <a href="{{ route('superadmin.globalsetup.countries.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        {{-- Top-level validation summary --}}
        @if ($errors->any())
            <div class="alert alert-danger">
                <strong>Please fix the following:</strong>
                <ul class="mb-0">
                    @foreach ($errors->all() as $err)
                        <li>{{ $err }}</li>
                    @endforeach
                </ul>
            </div>
        @endif

        <form method="POST" action="{{ route('superadmin.globalsetup.countries.store') }}" class="row g-3">
            @csrf

            <div class="col-md-6">
                <label class="form-label">Country Name <span class="text-danger">*</span></label>
                <input name="name" type="text" class="form-control @error('name') is-invalid @enderror"
                       value="{{ old('name') }}" maxlength="150" required>
                @error('name') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-3">
                <label class="form-label">Short Code</label>
                <input name="short_code" type="text" class="form-control @error('short_code') is-invalid @enderror"
                       value="{{ old('short_code') }}" maxlength="10" placeholder="e.g., BD">
                @error('short_code') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-12 mt-2">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-save"></i> Save
                </button>
                <a href="{{ route('superadmin.globalsetup.countries.index') }}" class="btn btn-secondary">
                    Return
                </a>
            </div>
        </form>
    </div>
</div>
@endsection


=== END FILE  ===



=== FILE: resources\views\backend\modules\global-setup\countries\edit.blade.php  ===

{{-- resources/views/backend/modules/global-setup/countries/edit.blade.php --}}
@extends('backend.layouts.master')

@push('styles')
    <style>
        body { background: #f6f8fa; }
        .page-card { background:#fff; border-radius:14px; box-shadow:0 6px 28px rgba(0,0,0,.06); padding:1rem 1rem 1.25rem; border:1px solid #e6ecf5; }
        .page-title { font-size:1.35rem; font-weight:700; margin:0; letter-spacing:.2px; }
        .alert ul { margin-bottom: 0; }
    </style>
@endpush

@section('content')
<div class="container py-3 py-md-4">
    <div class="page-card">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
            <h1 class="page-title mb-0">Edit Country <small class="text-muted">#{{ $country->id }}</small></h1>
            <a href="{{ route('superadmin.globalsetup.countries.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        {{-- Top-level validation summary --}}
        @if ($errors->any())
            <div class="alert alert-danger">
                <strong>Please fix the following:</strong>
                <ul class="mb-0">
                    @foreach ($errors->all() as $err)
                        <li>{{ $err }}</li>
                    @endforeach
                </ul>
            </div>
        @endif

        <form method="POST" action="{{ route('superadmin.globalsetup.countries.update', $country->id) }}" class="row g-3">
            @csrf @method('PUT')

            <div class="col-md-6">
                <label class="form-label">Country Name <span class="text-danger">*</span></label>
                <input name="name" type="text" class="form-control @error('name') is-invalid @enderror"
                       value="{{ old('name', $country->name) }}" maxlength="150" required>
                @error('name') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-md-3">
                <label class="form-label">Short Code</label>
                <input name="short_code" type="text" class="form-control @error('short_code') is-invalid @enderror"
                       value="{{ old('short_code', $country->short_code) }}" maxlength="10" placeholder="e.g., BD">
                @error('short_code') <div class="invalid-feedback">{{ $message }}</div> @enderror
            </div>

            <div class="col-12 mt-2">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-save"></i> Save
                </button>
                <a href="{{ route('superadmin.globalsetup.countries.index') }}" class="btn btn-secondary">
                    Return
                </a>
            </div>
        </form>
    </div>
</div>
@endsection

=== END FILE  ===



=== FILE: resources\views\backend\modules\global-setup\countries\show.blade.php  ===

{{-- resources/views/backend/modules/global-setup/countries/show.blade.php --}}
@extends('backend.layouts.master')

@push('styles')
    <style>
        body { background: #f6f8fa; }
        .page-card { background:#fff; border-radius:14px; box-shadow:0 6px 28px rgba(0,0,0,.06); padding:1rem 1rem 1.25rem; border:1px solid #e6ecf5; }
        .page-title { font-size:1.35rem; font-weight:700; margin:0; letter-spacing:.2px; }
    </style>
@endpush

@section('content')
<div class="container py-3 py-md-4">
    <div class="page-card">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
            <h1 class="page-title mb-0">View Country <small class="text-muted">#{{ $country->id }}</small></h1>
            <a href="{{ route('superadmin.globalsetup.countries.index') }}" class="btn btn-outline-secondary">
                <i class="fa fa-arrow-left"></i> Back to List
            </a>
        </div>

        <div class="row g-3">
            <div class="col-md-6">
                <div class="border rounded p-3 bg-light">
                    <div class="mb-2"><strong>Name:</strong> {{ $country->name ?? '—' }}</div>
                    <div class="mb-2"><strong>Short Code:</strong> {{ $country->short_code ?? '—' }}</div>
                    <div class="mb-2"><strong>Created At:</strong> {{ $country->created_at ? $country->created_at->format('Y-m-d H:i') : '—' }}</div>
                    <div class="mb-2"><strong>Updated At:</strong> {{ $country->updated_at ? $country->updated_at->format('Y-m-d H:i') : '—' }}</div>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection


=== END FILE  ===

====  Note:  reserved path :   resources\views\backend\modules\parameters\cluster\  
====  Note:  reserved path :   resources\views\backend\modules\parameters\division\  
====  Note:  reserved path :   resources\views\backend\modules\parameters\district\ 
====  Note:  reserved path :   resources\views\backend\modules\parameters\upazila\  



=== FILE: routes/Backend/Dashboard.php  ===

<?php
/* routes/Backend/Dashboard.php */

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\Backend\DashboardController;

/*
|----------------------------------------------------------------------
| Dashboard routes
|----------------------------------------------------------------------
| Default global dashboards
|   /dashboard/public  → public landing
|   /dashboard         → role-aware dashboard
|
| Tenant-specific dashboards (with company slug in URL)
|   /company/{company:slug}/dashboard/public
|   /company/{company:slug}/dashboard
|   → these allow logo/company context to show automatically
*/

/* -------- Global (non-tenant specific) -------- */
Route::get('/dashboard/public', [DashboardController::class, 'public'])
    ->name('dashboard.public');

Route::get('/dashboard', [DashboardController::class, 'index'])
    // ->middleware('auth') // enable after Breeze/Auth
    ->name('dashboard.index');

/* -------- Tenant-aware -------- */
Route::prefix('company/{company:slug}/dashboard')->name('company.dashboard.')->group(function () {
    Route::get('public', [DashboardController::class, 'public'])
        ->name('public');

    Route::get('/', [DashboardController::class, 'index'])
        ->name('index');
});


=== END FILE  ===



=== FILE: routes\SuperAdmin\GlobalSetup\GlobalSetup.php  ===

<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\SuperAdmin\GlobalSetup\CountryController;
use App\Http\Controllers\SuperAdmin\GlobalSetup\CompanyController;

/*
|--------------------------------------------------------------------------
| Super Admin » Global Setup
|--------------------------------------------------------------------------
| Thanks to App\Providers\AppServiceProvider::boot(), this file is loaded
| with:
|   URL prefix  = /superadmin/globalsetup
|   Name prefix = superadmin.globalsetup.
|
| So the resource below:
|   Route::resource('companies', CompanyController::class);
| becomes routes like:
|   GET  /superadmin/globalsetup/companies         -> superadmin.globalsetup.companies.index
|   GET  /superadmin/globalsetup/companies/create  -> superadmin.globalsetup.companies.create
|   POST /superadmin/globalsetup/companies         -> superadmin.globalsetup.companies.store
|   GET  /superadmin/globalsetup/companies/{id}    -> superadmin.globalsetup.companies.show
|   GET  /superadmin/globalsetup/companies/{id}/edit -> superadmin.globalsetup.companies.edit
|   PUT  /superadmin/globalsetup/companies/{id}    -> superadmin.globalsetup.companies.update
|   DELETE /superadmin/globalsetup/companies/{id}  -> superadmin.globalsetup.companies.destroy
|
| Same idea for countries (already in use).
*/

Route::resource('countries', CountryController::class);
Route::resource('companies', CompanyController::class);

=== END FILE  ===


=== FILE: .env  ===

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:fnXdEmVHAKU9KC0WjlU6J/SOm6BMXzU5F+I7PuvQw+g=
APP_DEBUG=true
APP_URL=http://localhost:8004

APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

APP_MAINTENANCE_DRIVER=file
# APP_MAINTENANCE_STORE=database

PHP_CLI_SERVER_WORKERS=4

BCRYPT_ROUNDS=12

LOG_CHANNEL=stack
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug


DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=trimatricsaas
DB_USERNAME=root
DB_PASSWORD=



HEADER_FORCE_USER_ID=1
IS_FORCED_REGISTRATION=1
REG_SOURCE=auto
REG_TABLE=
REG_USER_COLUMN=user_id
REG_STATUS_COLUMN=status
REG_STATUS_ACTIVE=1
REG_COMPANY_COLUMN=

SESSION_DRIVER=database
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null

BROADCAST_CONNECTION=log
FILESYSTEM_DISK=local
QUEUE_CONNECTION=database

CACHE_STORE=database
# CACHE_PREFIX=

MEMCACHED_HOST=127.0.0.1

REDIS_CLIENT=phpredis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=log
MAIL_SCHEME=null
MAIL_HOST=127.0.0.1
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_FROM_ADDRESS="hello@example.com"
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false

VITE_APP_NAME="${APP_NAME}"

=== END FILE  ===


